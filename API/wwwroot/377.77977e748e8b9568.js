"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[377],{9377:(L,u,c)=>{c.r(u),c.d(u,{RegistererModule:()=>R});var d=c(9808),_=c(4466),r=c(4182),p=c(1498),t=c(2096),h=c(425),g=c(7278),v=c(7987),m=c(2388);function x(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"li")(1,"button",5),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw().onSelect(l)}),t.TgZ(2,"span"),t._uU(3),t.qZA()()()}if(2&n){const e=s.$implicit,i=t.oxw();t.xp6(1),t.ekj("bg-blue-200",e===i.selectedPatient),t.xp6(2),t.AsE("",e.name," ",e.surname,"")}}let y=(()=>{class n{constructor(e){this.ps=e,this.selectedPatient=new t.vpe}ngOnInit(){}search(e){this.ps.getAllPatients(e).subscribe(i=>this.patientsSearched=i),console.log(this.patientsSearched)}onSelect(e){this.selectedPatient.emit(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.$))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-patients-list"]],hostAttrs:[1,"basis-full","min-h-0"],outputs:{selectedPatient:"selectedPatient"},decls:5,vars:1,consts:[[1,"h-full","flex","flex-col"],["id","search-box","placeholder","Search...",1,"p-1","placeholder-gray-500","bg-gray-200","w-full",3,"keyup.enter"],["searchBox",""],[1,"divide-y","divide-gray-200","max-h-full","overflow-y-auto"],[4,"ngFor","ngForOf"],["type","button",1,"hover:bg-gray-200","active:bg-gray-300","w-full","text-left","p-1",3,"click"]],template:function(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"div",0)(1,"input",1,2),t.NdJ("keyup.enter",function(){t.CHM(o);const a=t.MAs(2);return i.search(a.value)}),t.qZA(),t.TgZ(3,"ul",3),t.YNc(4,x,4,4,"li",4),t.qZA()()}2&e&&(t.xp6(4),t.Q6J("ngForOf",i.patientsSearched))},directives:[d.sg],styles:[""]}),n})();var b=c(5512),f=c(520),C=c(8031);let w=(()=>{class n{constructor(e,i){this.http=e,this.as=i,this.baseURL="http://"+location.hostname,this.queryDoctorsURL=this.baseURL+"/v1/Doctors"}getAllDoctors(){let e;return this.as.currentUser$.subscribe(i=>e=null==i?void 0:i.token),this.http.get(this.queryDoctorsURL,{headers:new f.WM({"Content-Type":"text/plain",Authorization:"Bearer "+e})})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(f.eN),t.LFG(C.B))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function S(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"li")(1,"button",18),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).setDoctor(l)}),t._uU(2),t.qZA()()}if(2&n){const e=s.$implicit;t.xp6(2),t.AsE("",e.name," ",e.surname,"")}}function T(n,s){if(1&n&&(t.TgZ(0,"ul",17),t.YNc(1,S,3,2,"li",15),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.doctors)}}function D(n,s){if(1&n&&(t.TgZ(0,"th")(1,"div",19),t._uU(2),t.qZA()()),2&n){const e=s.$implicit,i=t.oxw();t.xp6(2),t.Oqu(i.us.prettyTimeFromDate(e))}}function Z(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"button",24),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().index,l=t.oxw().index;return t.oxw().selectSlot({x:l,y:o})}),t._uU(1," Free "),t.qZA()}if(2&n){const e=t.oxw().index,i=t.oxw().index,o=t.oxw();t.Q6J("ngClass",o.chosenSlotID.x==i&&o.chosenSlotID.y==e?"bg-sky-500":"bg-sky-300")}}function A(n,s){1&n&&(t.TgZ(0,"div",25),t._uU(1," Booked "),t.qZA())}function P(n,s){if(1&n&&(t.TgZ(0,"td"),t.YNc(1,Z,2,1,"button",22),t.YNc(2,A,2,0,"ng-template",null,23,t.W1O),t.qZA()),2&n){const e=s.$implicit,i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",null==e)("ngIfElse",i)}}function O(n,s){if(1&n&&(t.TgZ(0,"tr")(1,"td",20)(2,"div",21),t._uU(3),t.qZA()(),t.YNc(4,P,4,2,"td",15),t.qZA()),2&n){const e=s.$implicit,i=s.index,o=t.oxw();t.xp6(3),t.Oqu(o.us.prettyDateFromDate(e)),t.xp6(1),t.Q6J("ngForOf",o.scheduledVisits[i])}}let F=(()=>{class n{constructor(e,i,o){this.ss=e,this.vs=i,this.us=o,this.stateChanged=new t.vpe,this.openingTime=new Date(0,0,0,8),this.closingTime=new Date(0,0,0,16),this.timeSlotLength=new Date(0,0,0,0,30),this.scheduledVisits=new Array(7),this.dateSlots=[],this.chosenSlotID={x:-1,y:-1}}ngOnInit(){this.dropdownVisibility=!1,this.timeSlots=this.prepareTimeSlots(this.openingTime,this.closingTime,this.timeSlotLength),this.ss.getAllDoctors().subscribe(e=>this.doctors=e)}selectSlot(e){this.chosenSlotID.x==e.x&&this.chosenSlotID.y==e.y?(this.chosenSlotID={x:-1,y:-1},this.chosenSlot=null):(this.chosenSlotID=e,this.chosenSlot=new Date(this.dateSlots[e.x]),this.chosenSlot.setHours(this.timeSlots[e.y].getHours()),this.chosenSlot.setMinutes(this.timeSlots[e.y].getMinutes())),console.log(`Chosen slot: ${this.us.prettyDateFromDate(this.chosenSlot)} ${this.us.prettyTimeFromDate(this.chosenSlot)} and id ${this.chosenSlotID.x} ${this.chosenSlotID.y}`)}registerVisit(){null!=this.chosenSlot&&this.chosenPatient?(this.vs.addVisit(this.chosenSlot,this.chosenDoctor.id,this.chosenPatient.id).subscribe(e=>{e&&(this.getSchedule(),this.stateChanged.emit(!0))}),this.chosenSlotID={x:-1,y:-1},this.chosenSlot=null):alert("Please select patient and a timeslot.")}setDate(e){this.chosenDate=new Date(e),this.getSchedule()}setDoctor(e){this.dropdownVisibility=!1,this.chosenDoctor=e,this.getSchedule()}getSchedule(){var e;if(this.chosenDate&&this.chosenDate.getTime()==this.chosenDate.getTime()&&this.chosenDoctor){console.log(`Getting schedule for doc ${this.chosenDoctor.name} ${this.chosenDoctor.surname} at ${this.chosenDate.toDateString()}...`),this.scheduledVisits=new Array(7),this.dateSlots=[];let i=new Date(this.chosenDate);i.setDate(i.getDate()-3),this.dateSlots.push(i);for(let o=0;o<7;o++)this.vs.getDoctorVisitsList(null===(e=this.chosenDoctor)||void 0===e?void 0:e.id,this.dateSlots[o],0).subscribe(l=>{this.scheduledVisits[o]=l,this.scheduledVisits[o].forEach((a,V,Y)=>{Y[V].date=this.us.localizeDate(a.date)});for(let a=0;a<this.timeSlots.length;a++)this.scheduledVisits[o][a]&&this.us.prettyTimeFromDate(this.scheduledVisits[o][a].date)==this.us.prettyTimeFromDate(this.timeSlots[a])||this.scheduledVisits[o].splice(a,0,null)}),i=new Date(this.dateSlots[o]),i.setDate(i.getDate()+1),this.dateSlots.push(i);this.dateSlots.pop()}}prepareTimeSlots(e,i,o){let l=[];for(;e.getTime()!=i.getTime();)l.push(new Date(e)),e.setMinutes(e.getMinutes()+o.getMinutes());return l}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(w),t.Y36(h.F),t.Y36(g.t))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-schedule"]],hostAttrs:[1,"grow","flex","flex-col","items-center","p-6","space-y-2"],inputs:{chosenPatient:"chosenPatient"},outputs:{stateChanged:"stateChanged"},decls:28,vars:4,consts:[[1,"text-2xl","font-medium"],[1,"w-full","flex","justify-around"],[1,"mr-8"],[1,"inline","mr-4"],[1,"inline","relative"],["type","button",1,"bg-gray-200","p-1","w-52","text-left",3,"click"],["class","absolute origin-top-left left-0 z-20 bg-white p-1 divide-y w-52 max-h-44 overflow-y-auto",4,"ngIf"],[1,"inline"],["type","date","min","01-01-2021","placeholder","today",1,"bg-gray-200","p-1",3,"input"],["dateInput",""],[1,"relative","grow","w-full","overflow-auto"],[1,"absolute","origin-top-left","top-0","left-0","flex","flex-col"],[1,"table-auto"],[1,"sticky","top-0","bg-gray-200","z-10"],[1,"w-28"],[4,"ngFor","ngForOf"],["type","button",1,"font-semibold","text-white","bg-blue-600","w-48","py-2","rounded-lg","hover:bg-blue-700","active:bg-blue-800",3,"click"],[1,"absolute","origin-top-left","left-0","z-20","bg-white","p-1","divide-y","w-52","max-h-44","overflow-y-auto"],[1,"hover:bg-gray-200","w-full","text-left",3,"click"],[1,"w-24"],[1,"bg-gray-200","sticky","left-0"],[1,"font-medium","flex","items-center","justify-center"],["type","button","class","h-16 w-full border border-gray-200  hover:bg-sky-700",3,"ngClass","click",4,"ngIf","ngIfElse"],["NA",""],["type","button",1,"h-16","w-full","border","border-gray-200","hover:bg-sky-700",3,"ngClass","click"],[1,"h-16","flex","items-center","justify-center","border","border-gray-200","bg-gray-300"]],template:function(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"h3",0),t._uU(1,"New visit"),t.qZA(),t.TgZ(2,"div",1)(3,"div",2)(4,"p",3),t._uU(5,"Doctor:"),t.qZA(),t.TgZ(6,"div",4)(7,"button",5),t.NdJ("click",function(){return i.dropdownVisibility=!i.dropdownVisibility}),t._uU(8),t.qZA(),t.YNc(9,T,2,1,"ul",6),t.qZA()(),t.TgZ(10,"div")(11,"p",3),t._uU(12,"Date:"),t.qZA(),t.TgZ(13,"div",7)(14,"input",8,9),t.NdJ("input",function(){t.CHM(o);const a=t.MAs(15);return i.setDate(a.value)}),t.qZA()()()(),t.TgZ(16,"div",10)(17,"div",11)(18,"table",12)(19,"thead",13)(20,"th")(21,"div",14),t._uU(22,"Date"),t.qZA()(),t.YNc(23,D,3,1,"th",15),t.qZA(),t.TgZ(24,"tbody"),t.YNc(25,O,5,2,"tr",15),t.qZA()()()(),t.TgZ(26,"button",16),t.NdJ("click",function(){return i.registerVisit()}),t._uU(27,"Register visit"),t.qZA()}2&e&&(t.xp6(8),t.Oqu(i.chosenDoctor?i.chosenDoctor.name+" "+i.chosenDoctor.surname:"Choose Doctor"),t.xp6(1),t.Q6J("ngIf",i.dropdownVisibility),t.xp6(14),t.Q6J("ngForOf",i.timeSlots),t.xp6(2),t.Q6J("ngForOf",i.dateSlots))},directives:[d.O5,d.sg,d.mk],styles:[""]}),n})();var k=c(3213);function J(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",2),t.NdJ("click",function(){return t.CHM(e),t.oxw().closeOverlay()}),t.qZA()}}function M(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4)(2,"h1",5),t._uU(3,"Add Patient"),t.qZA(),t._UZ(4,"br"),t.TgZ(5,"form",6),t._UZ(6,"input",7)(7,"br")(8,"br")(9,"input",8)(10,"br")(11,"br")(12,"input",9)(13,"br")(14,"br"),t.TgZ(15,"button",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().submitData()}),t._uU(16,"Add"),t.qZA()()()()}if(2&n){const e=t.oxw();t.xp6(5),t.Q6J("formGroup",e.form)}}let I=(()=>{class n{constructor(e){this.ps=e,this.activeChange=new t.vpe,this.form=new r.cw({name:new r.NI("",r.kI.required),surname:new r.NI("",r.kI.required),pesel:new r.NI("",[r.kI.pattern("^[0-9]{11}$"),r.kI.required])})}ngOnInit(){}closeOverlay(){this.active=!1,this.activeChange.emit(this.active)}submitData(){var e,i,o;if(this.form.valid){const l={id:null,name:null===(e=this.form.controls.name)||void 0===e?void 0:e.value,surname:null===(i=this.form.controls.surname)||void 0===i?void 0:i.value,pesel:null===(o=this.form.controls.pesel)||void 0===o?void 0:o.value};this.ps.addPatient(l),this.closeOverlay()}}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(m.$))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-add-patient-overlay"]],inputs:{active:"active"},outputs:{activeChange:"activeChange"},decls:2,vars:2,consts:[["class","absolute top-0 left-0 w-full h-full backdrop-blur-sm cursor-pointer",3,"click",4,"ngIf"],["id","window","class","absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 h-1/2 w-1/2 bg-white",4,"ngIf"],[1,"absolute","top-0","left-0","w-full","h-full","backdrop-blur-sm","cursor-pointer",3,"click"],["id","window",1,"absolute","top-1/2","left-1/2","-translate-x-1/2","-translate-y-1/2","h-1/2","w-1/2","bg-white"],[1,"container"],[1,"text-2xl","font-medium"],[3,"formGroup"],["required","","formControlName","name","id","name","type","text","size","30","placeholder","Name",1,"bg-gray-200"],["required","","formControlName","surname","id","surname","type","text","size","30","placeholder","Surname",1,"bg-gray-200"],["required","","formControlName","pesel","id","pesel","type","text","size","30","placeholder","PESEL",1,"bg-gray-200"],["type","button","size","30",1,"button",3,"click"]],template:function(e,i){1&e&&(t.YNc(0,J,1,0,"div",0),t.YNc(1,M,17,1,"div",1)),2&e&&(t.Q6J("ngIf",i.active),t.xp6(1),t.Q6J("ngIf",i.active))},directives:[d.O5,r._Y,r.JL,r.sg,r.Fj,r.Q7,r.JJ,r.u],styles:["#window[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;padding:0;width:653px;height:414px;background:linear-gradient(180deg,#F9FAFB 8.85%,#FFFFFF 63.54%,#BED8FD 100%);border-radius:28px}.container[_ngcontent-%COMP%]{margin-top:0;display:flex;flex-direction:column;justify-content:center;align-items:center}h1[_ngcontent-%COMP%]{text-align:center;font-style:normal;font-weight:600;font-size:20px;line-height:150%;flex:none;order:0;flex-grow:0}form[_ngcontent-%COMP%]{text-align:center}input[_ngcontent-%COMP%]{color:#000;padding:10px}#name[_ngcontent-%COMP%]{flex:none;order:0;flex-grow:0}#surname[_ngcontent-%COMP%]{flex:none;order:1;flex-grow:0}#pesel[_ngcontent-%COMP%]{flex:none;order:2;flex-grow:0}.button[_ngcontent-%COMP%]{color:#fff;font-weight:600;font-size:16px;line-height:150%;background:#1C64F2;text-align:center;border-radius:10px;padding:9px 122px;flex:none;order:0;flex-grow:1}.ng-valid[required][_ngcontent-%COMP%], .ng-valid.required[_ngcontent-%COMP%]{border-left:5px solid #42A948}.ng-invalid[_ngcontent-%COMP%]:not(form){border-left:5px solid #a94442}"]}),n})();function N(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"app-add-patient-overlay",17),t.NdJ("activeChange",function(o){return t.CHM(e),t.oxw().patientOverlayOn=o}),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("active",e.patientOverlayOn)}}const q=[{path:"",component:(()=>{class n{constructor(e,i){this.vs=e,this.us=i}ngOnInit(){}selectPatient(e){this.selectedPatient=e,this.vs.getPatientVisitsList(this.selectedPatient.id).subscribe(i=>{this.patientsVisits=i,this.patientsVisits.forEach((o,l,a)=>{a[l].date=this.us.localizeDate(o.date)})})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.F),t.Y36(g.t))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-registerer"]],hostAttrs:[1,"grow","flex"],decls:20,vars:5,consts:[[1,"grow","flex","h-screen","min-h-[700px]"],[1,"flex","flex-col","h-full","w-72","border-r-2","border-gray-200","bg-white"],[1,"p-3"],[3,"column"],[1,"p-3","flex","flex-col","gap-4","basis-full","min-h-0"],[1,"text-2xl","font-medium"],["type","button",1,"font-semibold","text-white","bg-blue-600","w-full","py-2","rounded-lg","hover:bg-blue-700","active:bg-blue-800",3,"click"],[3,"selectedPatient"],[1,"flex","flex-col","grow","h-full"],[1,"flex","basis-4/6"],[1,"flex","basis-1/4","border-r","border-gray-200"],[3,"chosenPatientData"],[1,"flex","basis-3/4","h-full"],[3,"chosenPatient","stateChanged"],[1,"flex","basis-2/6","min-h-0","border-t","border-gray-200"],[3,"visits","statusChange"],[3,"active","activeChange",4,"ngIf"],[3,"active","activeChange"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"app-account-controls",3),t.qZA(),t._UZ(4,"hr"),t.TgZ(5,"div",4)(6,"h3",5),t._uU(7,"Patients"),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){return i.patientOverlayOn=!0}),t._uU(9,"+ Add Patient"),t.qZA(),t.TgZ(10,"app-patients-list",7),t.NdJ("selectedPatient",function(l){return i.selectPatient(l)}),t.qZA()()(),t.TgZ(11,"div",8)(12,"div",9)(13,"div",10),t._UZ(14,"app-patient-data",11),t.qZA(),t.TgZ(15,"div",12)(16,"app-schedule",13),t.NdJ("stateChanged",function(){return i.selectPatient(i.selectedPatient)}),t.qZA()()(),t.TgZ(17,"div",14)(18,"app-patient-visits",15),t.NdJ("statusChange",function(){return i.selectPatient(i.selectedPatient)}),t.qZA()()()(),t.YNc(19,N,1,1,"app-add-patient-overlay",16)),2&e&&(t.xp6(3),t.Q6J("column",!0),t.xp6(11),t.Q6J("chosenPatientData",i.selectedPatient),t.xp6(2),t.Q6J("chosenPatient",i.selectedPatient),t.xp6(2),t.Q6J("visits",i.patientsVisits),t.xp6(1),t.Q6J("ngIf",i.patientOverlayOn))},directives:[v.n,y,b.e,F,k.c,d.O5,I],styles:[""]}),n})()}];let U=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.Bz.forChild(q)],p.Bz]}),n})(),R=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.ez,U,_.m,r.UX,r.u5]]}),n})()}}]);